{
    "1": {
        "inputs": {
            "ckpt_name": "v1-5-pruned-emaonly.safetensors"
        },
        "class_type": "CheckpointLoaderSimple",
        "_meta": { "title": "Load SD1.5" }
    },
    "2": {
        "inputs": {
            "lora_name": "pytorch_lora_weights.safetensors",
            "strength_model": 1,
            "strength_clip": 1,
            "model": ["1", 0],
            "clip": ["1", 1]
        },
        "class_type": "LoraLoader",
        "_meta": { "title": "LCM LoRA" }
    },
    "3": {
        "inputs": {
            "text": "a vibrant abstract landscape, glowing colors, cinematic, highly detailed",
            "clip": ["2", 1]
        },
        "class_type": "CLIPTextEncode",
        "_meta": { "title": "Positive Prompt" }
    },
    "4": {
        "inputs": {
            "text": "blurry, bad quality, watermark, text",
            "clip": ["2", 1]
        },
        "class_type": "CLIPTextEncode",
        "_meta": { "title": "Negative Prompt" }
    },
    "5": {
        "inputs": {
            "image": "td_frame.png",
            "upload": "image"
        },
        "class_type": "LoadImage",
        "_meta": { "title": "TD Input Frame" }
    },
    "23": {
        "inputs": {
            "target_width": 512,
            "target_height": 512,
            "padding_color": "white",
            "interpolation": "area",
            "image": ["5", 0]
        },
        "class_type": "ResizeAndPadImage",
        "_meta": { "title": "Resize Frame → 512" }
    },
    "6": {
        "inputs": {
            "pixels": ["23", 0],
            "vae": ["1", 2]
        },
        "class_type": "VAEEncode",
        "_meta": { "title": "Encode → Latent (img2img)" }
    },
    "7": {
        "inputs": {
            "control_net_name": "control_v11p_sd15_canny_fp16.safetensors"
        },
        "class_type": "ControlNetLoader",
        "_meta": { "title": "Load ControlNet Canny" }
    },
    "8": {
        "inputs": {
            "low_threshold": 100,
            "high_threshold": 200,
            "resolution": 512,
            "image": ["23", 0]
        },
        "class_type": "CannyEdgePreprocessor",
        "_meta": { "title": "Canny Preprocessor" }
    },
    "9": {
        "inputs": {
            "strength": 0.7,
            "start_percent": 0.0,
            "end_percent": 0.8,
            "positive": ["3", 0],
            "negative": ["4", 0],
            "control_net": ["7", 0],
            "image": ["8", 0]
        },
        "class_type": "ControlNetApplyAdvanced",
        "_meta": { "title": "Apply Canny ControlNet" }
    },
    "10": {
        "inputs": {
            "control_net_name": "control_v11f1p_sd15_depth_fp16.safetensors"
        },
        "class_type": "ControlNetLoader",
        "_meta": { "title": "Load ControlNet Depth" }
    },
    "11": {
        "inputs": {
            "a": 6.283185307179586,
            "bg_threshold": 0.1,
            "resolution": 512,
            "image": ["23", 0]
        },
        "class_type": "MiDaS-DepthMapPreprocessor",
        "_meta": { "title": "Depth Preprocessor (BYPASSED by default)" }
    },
    "12": {
        "inputs": {
            "strength": 0.7,
            "start_percent": 0.0,
            "end_percent": 0.8,
            "positive": ["3", 0],
            "negative": ["4", 0],
            "control_net": ["10", 0],
            "image": ["11", 0]
        },
        "class_type": "ControlNetApplyAdvanced",
        "_meta": { "title": "Apply Depth ControlNet (BYPASSED — rewire node 19 to use)" }
    },
    "13": {
        "inputs": {
            "preset": "PLUS (high strength)",
            "model": ["2", 0]
        },
        "class_type": "IPAdapterUnifiedLoader",
        "_meta": { "title": "IP-Adapter Unified Loader" }
    },
    "15": {
        "inputs": {
            "image": "ipadapter_ref.png",
            "upload": "image"
        },
        "class_type": "LoadImage",
        "_meta": { "title": "IP-Adapter 1 Reference Image" }
    },
    "24": {
        "inputs": {
            "target_width": 512,
            "target_height": 512,
            "padding_color": "white",
            "interpolation": "area",
            "image": ["15", 0]
        },
        "class_type": "ResizeAndPadImage",
        "_meta": { "title": "Resize IPA1 → 512" }
    },
    "16": {
        "inputs": {
            "weight": 0.6,
            "weight_type": "linear",
            "combine_embeds": "concat",
            "start_at": 0.0,
            "end_at": 1.0,
            "embeds_scaling": "V only",
            "model": ["2", 0],
            "ipadapter": ["13", 1],
            "image": ["24", 0]
        },
        "class_type": "IPAdapterAdvanced",
        "_meta": { "title": "Apply IP-Adapter 1" }
    },
    "17": {
        "inputs": {
            "image": "ipadapter_ref2.png",
            "upload": "image"
        },
        "class_type": "LoadImage",
        "_meta": { "title": "IP-Adapter 2 Reference Image (optional)" }
    },
    "22": {
        "inputs": {
            "target_width": 512,
            "target_height": 512,
            "padding_color": "white",
            "interpolation": "area",
            "image": ["17", 0]
        },
        "class_type": "ResizeAndPadImage",
        "_meta": { "title": "Resize IPA2 → 512" }
    },
    "18": {
        "inputs": {
            "weight": 0.4,
            "weight_type": "linear",
            "combine_embeds": "concat",
            "start_at": 0.0,
            "end_at": 1.0,
            "embeds_scaling": "V only",
            "model": ["16", 0],
            "ipadapter": ["13", 1],
            "image": ["22", 0]
        },
        "class_type": "IPAdapterAdvanced",
        "_meta": { "title": "Apply IP-Adapter 2 (chained — bypass to use only 1)" }
    },
    "19": {
        "inputs": {
            "seed": 42,
            "steps": 4,
            "cfg": 1.5,
            "sampler_name": "lcm",
            "scheduler": "sgm_uniform",
            "denoise": 0.75,
            "model": ["18", 0],
            "positive": ["9", 0],
            "negative": ["9", 1],
            "latent_image": ["6", 0]
        },
        "class_type": "KSampler",
        "_meta": { "title": "KSampler LCM img2img (depth: rewire positive/negative to [12,0],[12,1])" }
    },
    "20": {
        "inputs": {
            "samples": ["19", 0],
            "vae": ["1", 2]
        },
        "class_type": "VAEDecode",
        "_meta": { "title": "VAE Decode" }
    },
    "21": {
        "inputs": {
            "filename_prefix": "td_out",
            "images": ["20", 0]
        },
        "class_type": "SaveImage",
        "_meta": { "title": "Save → TD" }
    }
}
